

<!DOCTYPE html>
<html>
<head>
	<title>Home Page</title>
	<script type="text/javascript" src="/static/js/jquery.js"></script>

<style type="text/css">
	.err_msg{color:red;}
</style>


</head>
<body>

<form onsubmit="event.preventDefault(); return submitForm();">
	Number of Repositories: <input type="number" name="records" value=100 id="form_records">
	<span class="err_msg" id="records_error"></span> <br>


	Date: <input type="date" name="date" id="form_date">
	<span class="err_msg" id="date_error"></span> <br>
	Order: <select name="order" id="form_order">
	  <option value="desc" selected>Descending</option>
	  <option value="asc">Ascending</option>
	</select>	
	<span class="err_msg" id="order"></span> <br><br>
	<input type="submit" value="Submit">
</form>

<hr>
<div id="langs"></div>
<hr>
<div id="repos"></div>




<script type="text/javascript">



let date = new Date(Date.now());
date.setMonth(date.getMonth() - 1);
var currentDate = date.toISOString().substring(0,10);
document.getElementById('form_date').value = currentDate;

function zero_errors(){
	var error_elements = document.getElementsByClassName('err_msg');
	for (var i = error_elements.length - 1; i >= 0; i--) {
		error_elements[i].innerHTML="";
	}
}







function submitForm()
{	
	var form_records = document.getElementById('form_records').value;
	var form_date = document.getElementById('form_date').value;
	var form_order = document.getElementById('form_order').value;
	console.log(form_records, form_date, form_order);
	zero_errors();

	document.getElementById('langs').innerHTML = "Loading, Please Wait ...";
	document.getElementById('repos').innerHTML = "Loading, Please Wait ...";

$.ajax({
  url: "/api/search",
  type: "get", //send it through get method
  data: {
  	"date":form_date,
  	"order":form_order,
  	"records":form_records
  }
}).catch(function(resp) {
  var errors = resp.responseJSON.data;
  //console.log(errors);
  for (err in errors) {
  //console.log(err);
  //console.log(errors[err][0]);
  document.getElementById(err+"_error").innerHTML = errors[err][0];
}


});




}








</script>

</body>
</html>